---
- name: 'Create user home dir'
  file: { name: "{{ main_user_homedir }}", state: directory, owner: "{{ name }}", group: "{{ name }}", mode: "0750" }

- name: 'Import user setting files'
  script: 'bin/create-home-dir.sh'
  args:
    creates: "{{ main_user_homedir }}/.homebak/.git/index"
  become: true
  become_user: "{{ name }}"

- name: 'Customize the user further'
  user:
    name: "{{ name }}"
    groups: "{{ main_user_default_groups + main_user_extra_groups }}"
    append: true
    comment: "{{ comment }}"
    generate_ssh_key: true
    ssh_key_comment: "{{ main_user_name }}@{{ ansible_hostname }}"
